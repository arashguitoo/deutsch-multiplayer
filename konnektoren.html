<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚ö° Konnektoren-Quiz</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:linear-gradient(135deg,#e74c3c 0%,#c0392b 100%);min-height:100vh;color:#fff}
        .container{max-width:800px;margin:0 auto;padding:15px}
        h1{text-align:center;font-size:1.4em;margin-bottom:15px}
        .screen{display:none}.screen.active{display:block}
        #login-screen.active{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:85vh;gap:12px}
        .logo{font-size:3.5em;margin-bottom:5px}
        #login-screen h2{font-size:1.1em;text-align:center;opacity:0.9}
        .info-box{background:rgba(0,0,0,0.2);padding:12px 18px;border-radius:12px;font-size:0.85em;max-width:350px;text-align:center;line-height:1.6}
        .mode-select{display:flex;gap:10px;margin:15px 0}
        .mode-btn{flex:1;padding:15px;border:3px solid rgba(255,255,255,0.3);border-radius:15px;background:rgba(255,255,255,0.1);color:#fff;font-size:1em;font-weight:700;cursor:pointer;text-align:center}
        .mode-btn:hover,.mode-btn.selected{border-color:#ffd700;background:rgba(255,215,0,0.2)}
        .mode-btn .icon{font-size:1.5em;display:block;margin-bottom:5px}
        .team-count-select{display:none;gap:8px;margin:10px 0}.team-count-select.show{display:flex}
        .team-count-btn{padding:12px 20px;border:2px solid rgba(255,255,255,0.3);border-radius:12px;background:rgba(255,255,255,0.1);color:#fff;font-weight:700;cursor:pointer}
        .team-count-btn:hover,.team-count-btn.selected{border-color:#ffd700;background:rgba(255,215,0,0.2)}
        .team-select-grid{display:none;grid-template-columns:1fr 1fr;gap:8px;margin:10px 0;width:100%;max-width:300px}.team-select-grid.show{display:grid}
        .team-select-btn{padding:12px;border:3px solid;border-radius:12px;background:rgba(255,255,255,0.1);color:#fff;font-weight:700;cursor:pointer}
        .team-select-btn:hover,.team-select-btn.selected{transform:scale(1.02);filter:brightness(1.2)}
        .team-select-btn.t1{border-color:#3498db}.team-select-btn.t2{border-color:#2ecc71}.team-select-btn.t3{border-color:#f39c12}.team-select-btn.t4{border-color:#9b59b6}
        .difficulty-select{display:flex;gap:8px;margin:10px 0;flex-wrap:wrap;justify-content:center}
        .diff-btn{padding:12px 20px;border:2px solid rgba(255,255,255,0.3);border-radius:12px;background:rgba(255,255,255,0.1);color:#fff;font-size:0.9em;font-weight:700;cursor:pointer}
        .diff-btn.einfach.selected{border-color:#2ecc71;background:rgba(46,204,113,0.3)}
        .diff-btn.mittel.selected{border-color:#f39c12;background:rgba(243,156,18,0.3)}
        .diff-btn.schwer.selected{border-color:#9b59b6;background:rgba(155,89,182,0.3)}
        .input-group{display:flex;flex-direction:column;gap:10px;width:100%;max-width:300px}
        .input-group input{font-size:1.1em;padding:12px 20px;border:2px solid rgba(255,255,255,0.5);border-radius:25px;text-align:center;background:rgba(255,255,255,0.15);color:#fff}
        .input-group input::placeholder{color:rgba(255,255,255,0.6)}
        .input-group input.code-input{font-size:1.3em;letter-spacing:6px;text-transform:uppercase}
        .btn-primary{font-size:1.1em;padding:15px 40px;border:none;border-radius:30px;background:linear-gradient(135deg,#ffd700,#ffaa00);color:#333;font-weight:700;cursor:pointer;width:100%;max-width:300px}
        .btn-primary:disabled{opacity:0.5;cursor:not-allowed}
        .btn-secondary{font-size:1em;padding:12px 30px;border:2px solid rgba(255,255,255,0.5);border-radius:25px;background:transparent;color:#fff;cursor:pointer;width:100%;max-width:300px}
        .divider{display:flex;align-items:center;gap:15px;width:100%;max-width:300px;margin:5px 0;color:rgba(255,255,255,0.5)}
        .divider::before,.divider::after{content:'';flex:1;height:1px;background:rgba(255,255,255,0.3)}
        .error-msg{color:#ffcccc;background:rgba(0,0,0,0.2);padding:10px 15px;border-radius:10px;font-size:0.9em;display:none;max-width:300px;text-align:center}.error-msg.show{display:block}
        .lobby-box{background:rgba(0,0,0,0.15);border-radius:20px;padding:20px;margin:15px 0;text-align:center}
        .lobby-code{font-size:2.5em;color:#ffd700;letter-spacing:8px;margin:10px 0;font-weight:700}
        .lobby-info{display:flex;justify-content:center;gap:15px;flex-wrap:wrap;margin:15px 0}
        .lobby-badge{padding:8px 15px;border-radius:20px;font-size:0.85em;font-weight:600;background:rgba(255,255,255,0.2)}
        .players-list,.teams-list{margin:20px 0}
        .players-grid{display:flex;flex-wrap:wrap;gap:8px;justify-content:center}
        .player-chip{padding:8px 15px;background:rgba(255,255,255,0.15);border-radius:20px;font-size:0.9em}.player-chip.host{border:2px solid #ffd700}
        .teams-grid{display:grid;gap:12px;margin:15px 0}
        .teams-grid.t2{grid-template-columns:1fr 1fr}.teams-grid.t3{grid-template-columns:1fr 1fr 1fr}.teams-grid.t4{grid-template-columns:1fr 1fr}
        @media(max-width:500px){.teams-grid.t3,.teams-grid.t4{grid-template-columns:1fr}}
        .team-box{background:rgba(255,255,255,0.08);border-radius:12px;padding:12px;border-left:4px solid}
        .team-box.t1{border-color:#3498db}.team-box.t2{border-color:#2ecc71}.team-box.t3{border-color:#f39c12}.team-box.t4{border-color:#9b59b6}
        .team-box h4{font-size:0.9em;margin-bottom:8px}
        .team-box h4 .dot{width:10px;height:10px;border-radius:50%;display:inline-block;margin-right:5px}
        .team-box.t1 .dot{background:#3498db}.team-box.t2 .dot{background:#2ecc71}.team-box.t3 .dot{background:#f39c12}.team-box.t4 .dot{background:#9b59b6}
        .team-players{display:flex;flex-wrap:wrap;gap:5px;min-height:25px}
        .team-player{padding:4px 10px;background:rgba(255,255,255,0.1);border-radius:10px;font-size:0.8em}
        .host-controls{margin-top:20px}
        .start-btn{font-size:1.2em;padding:15px 50px;border:none;border-radius:30px;background:linear-gradient(135deg,#2ecc71,#27ae60);color:#fff;font-weight:700;cursor:pointer}
        .start-btn:disabled{opacity:0.5;cursor:not-allowed}
        .host-label{color:#ffd700;font-size:0.85em;margin-top:10px}
        .reset-btn{margin-top:15px;padding:8px 20px;border:1px solid rgba(255,255,255,0.3);border-radius:15px;background:transparent;color:#fff;font-size:0.85em;cursor:pointer}
        .player-wait{color:rgba(255,255,255,0.7);font-style:italic}
        .game-header{display:flex;justify-content:space-between;align-items:center;padding:12px 15px;background:rgba(0,0,0,0.15);border-radius:15px;margin-bottom:15px;flex-wrap:wrap;gap:10px}
        .game-info{display:flex;align-items:center;gap:15px}
        .timer{font-size:2em;font-weight:700;color:#ffd700;min-width:50px;text-align:center}
        .timer.warning{color:#f39c12}.timer.danger{color:#fff;animation:pulse 0.3s infinite}
        @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.15)}}
        .question-counter{font-size:0.95em;opacity:0.9}
        .my-score{font-size:1.1em;font-weight:600}
        .my-team-indicator{padding:5px 12px;border-radius:15px;font-size:0.85em;font-weight:600}
        .my-team-indicator.t1{background:rgba(52,152,219,0.3);border:2px solid #3498db}
        .my-team-indicator.t2{background:rgba(46,204,113,0.3);border:2px solid #2ecc71}
        .my-team-indicator.t3{background:rgba(243,156,18,0.3);border:2px solid #f39c12}
        .my-team-indicator.t4{background:rgba(155,89,182,0.3);border:2px solid #9b59b6}
        .scoreboard{display:flex;justify-content:center;gap:10px;margin-bottom:15px;flex-wrap:wrap}
        .score-item{padding:10px 20px;border-radius:12px;text-align:center;min-width:80px}
        .score-item.t1{background:rgba(52,152,219,0.25);border:2px solid #3498db}
        .score-item.t2{background:rgba(46,204,113,0.25);border:2px solid #2ecc71}
        .score-item.t3{background:rgba(243,156,18,0.25);border:2px solid #f39c12}
        .score-item.t4{background:rgba(155,89,182,0.25);border:2px solid #9b59b6}
        .score-item .team-name{font-size:0.8em;opacity:0.8}.score-item .team-score{font-size:1.4em;font-weight:700}
        .quiz-section{background:rgba(0,0,0,0.1);border-radius:20px;padding:20px;border:2px solid rgba(255,255,255,0.1)}
        .category{display:inline-block;padding:5px 15px;background:rgba(255,255,255,0.15);border-radius:15px;font-size:0.85em;margin-bottom:15px}
        .question{font-size:1.2em;margin-bottom:15px;line-height:1.5;text-align:center}
        .answers{display:grid;grid-template-columns:1fr 1fr;gap:10px}
        @media(max-width:450px){.answers{grid-template-columns:1fr}}
        .answer-btn{padding:16px;font-size:1.05em;border:3px solid rgba(255,255,255,0.25);border-radius:15px;background:rgba(255,255,255,0.08);color:#fff;cursor:pointer;font-weight:600;text-align:center}
        .answer-btn:hover:not(:disabled){background:rgba(255,255,255,0.15);border-color:rgba(255,255,255,0.5)}
        .answer-btn:disabled{cursor:not-allowed;opacity:0.7}
        .answer-btn.correct{background:rgba(46,204,113,0.5);border-color:#2ecc71}
        .answer-btn.wrong{background:rgba(0,0,0,0.3);border-color:#fff}
        .feedback{text-align:center;padding:12px;margin-top:15px;border-radius:12px;font-weight:600;display:none}
        .feedback.show{display:block}
        .feedback.correct{background:rgba(46,204,113,0.25);color:#2ecc71}
        .feedback.wrong{background:rgba(0,0,0,0.2);color:#fff}
        .feedback.timeout{background:rgba(243,156,18,0.25);color:#f39c12}
        .live-players{margin-top:15px;padding:12px;background:rgba(0,0,0,0.1);border-radius:12px}
        .live-players h4{font-size:0.85em;margin-bottom:8px;opacity:0.7}
        .live-players-grid{display:flex;flex-wrap:wrap;gap:6px}
        .live-player{padding:4px 10px;border-radius:10px;font-size:0.8em;background:rgba(255,255,255,0.1)}
        .live-player.answered{background:rgba(46,204,113,0.3)}.live-player.me{border:1px solid #ffd700}
        #result-screen{text-align:center;padding:20px}
        .result-icon{font-size:4em;margin-bottom:10px}
        .result-title{font-size:1.5em;margin-bottom:20px}
        .final-standings{background:rgba(0,0,0,0.1);border-radius:15px;padding:20px;margin:20px 0}
        .standing-row{display:flex;justify-content:space-between;align-items:center;padding:12px 15px;margin:8px 0;border-radius:10px;background:rgba(255,255,255,0.05)}
        .standing-row.winner{background:rgba(255,215,0,0.2);border:2px solid #ffd700}
        .standing-row.me{border:2px solid rgba(255,255,255,0.5)}
        .standing-rank{font-size:1.3em;min-width:40px}
        .standing-name{flex:1;text-align:left;margin-left:10px}
        .standing-score{font-weight:700;font-size:1.1em}
        .connection{position:fixed;top:10px;right:10px;padding:5px 12px;border-radius:15px;font-size:0.75em;background:rgba(0,0,0,0.3)}
        .connection.online{color:#2ecc71}.connection.offline{color:#fff}
    </style>
</head>
<body>
    <div class="connection" id="connection">Verbinde...</div>
    <div class="container">
        <h1>‚ö° Konnektoren-Quiz</h1>
        <div id="login-screen" class="screen active">
            <div class="logo">‚ö°</div>
            <h2>weil ‚Ä¢ obwohl ‚Ä¢ deshalb ‚Ä¢ trotzdem</h2>
            <div class="info-box"><b>8 Sekunden</b> pro Frage!<br>Schnell denken & klicken!</div>
            <div class="mode-select">
                <button class="mode-btn selected" data-mode="einzeln"><span class="icon">üë§</span>Einzeln</button>
                <button class="mode-btn" data-mode="team"><span class="icon">üë•</span>Teams</button>
            </div>
            <div class="team-count-select" id="team-count-select">
                <button class="team-count-btn selected" data-count="2">2 Teams</button>
                <button class="team-count-btn" data-count="3">3 Teams</button>
                <button class="team-count-btn" data-count="4">4 Teams</button>
            </div>
            <div class="difficulty-select">
                <button class="diff-btn einfach selected" data-diff="einfach">üü¢ Einfach</button>
                <button class="diff-btn mittel" data-diff="mittel">üü° Mittel</button>
                <button class="diff-btn schwer" data-diff="schwer">üî¥ Schwer</button>
            </div>
            <div class="input-group"><input type="text" id="player-name" placeholder="Dein Name" maxlength="15" autocomplete="off"></div>
            <div class="team-select-grid" id="team-select-grid">
                <button class="team-select-btn t1" data-team="1">üîµ Team 1</button>
                <button class="team-select-btn t2" data-team="2">üü¢ Team 2</button>
                <button class="team-select-btn t3" data-team="3">üü° Team 3</button>
                <button class="team-select-btn t4" data-team="4">üü£ Team 4</button>
            </div>
            <div class="input-group"><input type="text" id="game-code" class="code-input" placeholder="CODE" maxlength="4" autocomplete="off"></div>
            <button class="btn-primary" id="join-btn">üö™ Spiel beitreten</button>
            <div class="divider"><span>oder</span></div>
            <button class="btn-secondary" id="create-btn">üëë Neues Spiel erstellen</button>
            <div class="error-msg" id="error-msg"></div>
        </div>
        <div id="lobby-screen" class="screen">
            <div class="lobby-box">
                <h2>üéÆ Warteraum</h2>
                <div class="lobby-code" id="lobby-code">----</div>
                <div class="lobby-info"><span class="lobby-badge" id="lobby-mode">üë§ Einzeln</span><span class="lobby-badge" id="lobby-diff">üü¢ Einfach</span></div>
                <div class="players-list" id="players-list"><div class="players-grid" id="players-grid"></div></div>
                <div class="teams-list" id="teams-list" style="display:none"><div class="teams-grid" id="teams-grid"></div></div>
                <div class="host-controls" id="host-controls" style="display:none">
                    <button class="start-btn" id="start-btn" disabled>‚ñ∂Ô∏è Spiel starten</button>
                    <p class="host-label">üëë Du bist Spielleiter</p>
                    <button class="reset-btn" id="reset-btn">üîÑ Zur√ºcksetzen</button>
                </div>
                <div id="player-controls" style="display:none"><p class="player-wait">‚è≥ Warte auf Spielleiter...</p></div>
            </div>
        </div>
        <div id="game-screen" class="screen">
            <div class="scoreboard" id="scoreboard" style="display:none"></div>
            <div class="game-header">
                <div class="game-info"><div class="timer" id="timer">8</div><div class="question-counter" id="question-counter">1/20</div></div>
                <div class="my-score" id="my-score">‚≠ê 0</div>
                <div class="my-team-indicator" id="my-team-indicator" style="display:none"></div>
            </div>
            <div class="quiz-section">
                <div class="category" id="category">Kategorie</div>
                <div class="question" id="question">Frage wird geladen...</div>
                <div class="answers" id="answers"></div>
                <div class="feedback" id="feedback"></div>
            </div>
            <div class="live-players" id="live-players"><h4>üë• Spieler</h4><div class="live-players-grid" id="live-players-grid"></div></div>
        </div>
        <div id="result-screen" class="screen">
            <div class="result-icon" id="result-icon">üèÜ</div>
            <h2 class="result-title" id="result-title">Spiel beendet!</h2>
            <div class="final-standings" id="final-standings"></div>
            <button class="btn-primary" id="back-btn">üè† Zur√ºck zum Start</button>
        </div>
    </div>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script>
    (function(){
        'use strict';
        var CONFIG={TIMER_SECONDS:8,QUESTIONS_COUNT:20,TRANSITION_DELAY:2000,FIREBASE:{apiKey:"AIzaSyBDChXlm34Kr7Gg0Dw458GiiwoLnWJAnxM",authDomain:"lern-deutsch-arash.firebaseapp.com",databaseURL:"https://lern-deutsch-arash-default-rtdb.europe-west1.firebasedatabase.app",projectId:"lern-deutsch-arash"},DB_PATH:"konn2"};
        var QUESTIONS={einfach:[{cat:"weil",q:"Ich bleibe zu Hause, ___ ich krank bin.",a:["weil","obwohl","deshalb","trotzdem"],c:0},{cat:"weil",q:"Sie lernt Deutsch, ___ sie in Deutschland arbeiten will.",a:["weil","obwohl","deshalb","trotzdem"],c:0},{cat:"weil",q:"Er ist m√ºde, ___ er schlecht geschlafen hat.",a:["weil","obwohl","deshalb","trotzdem"],c:0},{cat:"deshalb",q:"Es regnet. ___ bleibe ich zu Hause.",a:["Deshalb","Weil","Obwohl","Trotzdem"],c:0},{cat:"deshalb",q:"Ich bin krank. ___ gehe ich zum Arzt.",a:["Deshalb","Weil","Obwohl","Trotzdem"],c:0},{cat:"deshalb",q:"Er hat kein Geld. ___ kann er nicht kaufen.",a:["Deshalb","Weil","Obwohl","Trotzdem"],c:0},{cat:"obwohl",q:"Ich gehe spazieren, ___ es regnet.",a:["obwohl","weil","deshalb","trotzdem"],c:0},{cat:"obwohl",q:"Er arbeitet, ___ er krank ist.",a:["obwohl","weil","deshalb","trotzdem"],c:0},{cat:"obwohl",q:"Sie lacht, ___ sie traurig ist.",a:["obwohl","weil","deshalb","trotzdem"],c:0},{cat:"trotzdem",q:"Es regnet. ___ gehe ich spazieren.",a:["Trotzdem","Deshalb","Weil","Obwohl"],c:0},{cat:"trotzdem",q:"Er ist m√ºde. ___ arbeitet er weiter.",a:["Trotzdem","Deshalb","Weil","Obwohl"],c:0},{cat:"trotzdem",q:"Sie hat wenig Zeit. ___ hilft sie mir.",a:["Trotzdem","Deshalb","Weil","Obwohl"],c:0},{cat:"und",q:"Ich lese ___ schreibe gern.",a:["und","oder","aber","sondern"],c:0},{cat:"oder",q:"M√∂chtest du Tee ___ Kaffee?",a:["oder","und","aber","sondern"],c:0},{cat:"aber",q:"Ich bin m√ºde, ___ ich arbeite weiter.",a:["aber","und","oder","sondern"],c:0},{cat:"denn",q:"Ich bleibe zu Hause, ___ ich bin krank.",a:["denn","weil","obwohl","deshalb"],c:0},{cat:"denn",q:"Sie weint, ___ sie ist traurig.",a:["denn","weil","obwohl","deshalb"],c:0},{cat:"sondern",q:"Er trinkt nicht Tee, ___ Kaffee.",a:["sondern","aber","oder","und"],c:0},{cat:"weil",q:"___ das Wetter sch√∂n ist, gehen wir raus.",a:["Weil","Deshalb","Trotzdem","Obwohl"],c:0},{cat:"obwohl",q:"___ er reich ist, ist er ungl√ºcklich.",a:["Obwohl","Weil","Deshalb","Trotzdem"],c:0}],mittel:[{cat:"damit",q:"Ich lerne Deutsch, ___ ich in Deutschland studieren kann.",a:["damit","weil","obwohl","um"],c:0},{cat:"damit",q:"Er spricht langsam, ___ alle verstehen.",a:["damit","weil","obwohl","sodass"],c:0},{cat:"sodass",q:"Er war so m√ºde, ___ er einschlief.",a:["sodass","damit","weil","obwohl"],c:0},{cat:"falls",q:"___ du Zeit hast, ruf mich an.",a:["Falls","Weil","Obwohl","Damit"],c:0},{cat:"falls",q:"Nimm einen Schirm mit, ___ es regnet.",a:["falls","weil","obwohl","damit"],c:0},{cat:"wenn",q:"___ ich Zeit habe, lese ich.",a:["Wenn","Weil","Obwohl","Damit"],c:0},{cat:"als",q:"___ ich Kind war, spielte ich viel.",a:["Als","Wenn","Weil","Obwohl"],c:0},{cat:"w√§hrend",q:"___ ich esse, h√∂re ich Musik.",a:["W√§hrend","Weil","Obwohl","Bevor"],c:0},{cat:"bevor",q:"Wasch dir die H√§nde, ___ du isst.",a:["bevor","nachdem","w√§hrend","weil"],c:0},{cat:"nachdem",q:"___ ich gegessen hatte, ging ich spazieren.",a:["Nachdem","Bevor","W√§hrend","Weil"],c:0},{cat:"seitdem",q:"___ er hier wohnt, ist er gl√ºcklich.",a:["Seitdem","Bevor","Nachdem","W√§hrend"],c:0},{cat:"bis",q:"Warte hier, ___ ich zur√ºckkomme.",a:["bis","wenn","weil","obwohl"],c:0},{cat:"indem",q:"Man lernt, ___ man √ºbt.",a:["indem","weil","obwohl","damit"],c:0},{cat:"ohne dass",q:"Er ging, ___ er sich verabschiedete.",a:["ohne dass","obwohl","weil","damit"],c:0},{cat:"anstatt dass",q:"___ er hilft, sitzt er nur da.",a:["Anstatt dass","Obwohl","Weil","Damit"],c:0},{cat:"je...desto",q:"___ mehr ich lerne, ___ besser verstehe ich.",a:["Je...desto","Wenn...dann","Weil...deshalb","Obwohl...trotzdem"],c:0},{cat:"sowohl...als auch",q:"Er spricht ___ Deutsch ___ Englisch.",a:["sowohl...als auch","entweder...oder","weder...noch","nicht nur...sondern auch"],c:0},{cat:"entweder...oder",q:"Du musst dich entscheiden: ___ ja ___ nein.",a:["entweder...oder","sowohl...als auch","weder...noch","nicht nur"],c:0},{cat:"weder...noch",q:"Er kann ___ schwimmen ___ tauchen.",a:["weder...noch","sowohl...als auch","entweder...oder","nicht nur"],c:0},{cat:"zwar...aber",q:"Das Essen ist ___ teuer, ___ sehr gut.",a:["zwar...aber","sowohl...als auch","weder...noch","entweder...oder"],c:0}],schwer:[{cat:"insofern als",q:"Das ist richtig, ___ man es so interpretiert.",a:["insofern als","obwohl","weil","falls"],c:0},{cat:"es sei denn",q:"Ich komme, ___ es regnet.",a:["es sei denn","obwohl","weil","damit"],c:0},{cat:"geschweige denn",q:"Er kann nicht laufen, ___ rennen.",a:["geschweige denn","obwohl","weil","sodass"],c:0},{cat:"zumal",q:"Er sollte aufh√∂ren, ___ er krank ist.",a:["zumal","obwohl","damit","sodass"],c:0},{cat:"sofern",q:"___ Sie Fragen haben, rufen Sie an.",a:["Sofern","Obwohl","Weil","Damit"],c:0},{cat:"wenngleich",q:"___ er reich ist, lebt er bescheiden.",a:["Wenngleich","Weil","Damit","Sodass"],c:0},{cat:"infolgedessen",q:"Es regnete stark. ___ wurde das Spiel abgesagt.",a:["Infolgedessen","Obwohl","Weil","Trotzdem"],c:0},{cat:"nichtsdestotrotz",q:"Es war schwer. ___ hat er es geschafft.",a:["Nichtsdestotrotz","Deshalb","Weil","Obwohl"],c:0},{cat:"wobei",q:"Er half mir, ___ er wenig Zeit hatte.",a:["wobei","weil","obwohl","damit"],c:0},{cat:"wohingegen",q:"Sie ist flei√üig, ___ er faul ist.",a:["wohingegen","weil","obwohl","damit"],c:0},{cat:"angesichts dessen",q:"___, dass die Lage ernst ist, m√ºssen wir handeln.",a:["Angesichts dessen","Obwohl","Weil","Trotzdem"],c:0},{cat:"ungeachtet dessen",q:"___, dass er warnte, machten sie weiter.",a:["Ungeachtet dessen","Weil","Obwohl","Damit"],c:0},{cat:"vorausgesetzt",q:"Ich komme, ___ ich Zeit habe.",a:["vorausgesetzt","obwohl","weil","damit"],c:0},{cat:"angenommen",q:"___, er sagt die Wahrheit, was dann?",a:["Angenommen","Obwohl","Weil","Damit"],c:0},{cat:"folglich",q:"Er lernte nicht. ___ fiel er durch.",a:["Folglich","Obwohl","Trotzdem","Weil"],c:0},{cat:"demzufolge",q:"Die Stra√üen sind nass. ___ hat es geregnet.",a:["Demzufolge","Obwohl","Trotzdem","Weil"],c:0},{cat:"allerdings",q:"Das Essen war gut. ___ war es teuer.",a:["Allerdings","Deshalb","Weil","Trotzdem"],c:0},{cat:"dennoch",q:"Er war m√ºde. ___ arbeitete er weiter.",a:["Dennoch","Deshalb","Weil","Obwohl"],c:0},{cat:"hingegen",q:"Sie arbeitet viel. Er ___ ist faul.",a:["hingegen","deshalb","weil","obwohl"],c:0},{cat:"indessen",q:"Sie kochte. ___ r√§umte er auf.",a:["Indessen","Deshalb","Weil","Obwohl"],c:0}]};
        var state={db:null,gameRef:null,playersRef:null,scoresRef:null,gameCode:null,playerId:null,playerName:'',isHost:false,mode:'einzeln',teamCount:2,myTeam:null,difficulty:'einfach',currentQuestion:-1,questions:[],myScore:0,teamScores:{},answered:false,timerInterval:null,players:[],connected:false};
        function $(id){return document.getElementById(id)}function $$(sel){return document.querySelectorAll(sel)}
        function shuffle(arr){var a=arr.slice();for(var i=a.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1));var t=a[i];a[i]=a[j];a[j]=t}return a}
        function generateCode(){var chars='ABCDEFGHJKLMNPQRSTUVWXYZ23456789';var code='';for(var i=0;i<4;i++)code+=chars.charAt(Math.floor(Math.random()*chars.length));return code}
        function showScreen(id){var screens=$$('.screen');for(var i=0;i<screens.length;i++)screens[i].classList.remove('active');$(id).classList.add('active')}
        function showError(msg){var el=$('error-msg');el.textContent=msg;el.classList.add('show');setTimeout(function(){el.classList.remove('show')},4000)}
        function updateConnection(status){var el=$('connection');el.className='connection '+status;el.textContent=status==='online'?'üü¢ Verbunden':'üî¥ Offline'}
        function setupUI(){var modeBtns=$$('.mode-btn');for(var i=0;i<modeBtns.length;i++){modeBtns[i].onclick=function(){for(var j=0;j<modeBtns.length;j++)modeBtns[j].classList.remove('selected');this.classList.add('selected');state.mode=this.getAttribute('data-mode');updateModeUI()}}var teamCountBtns=$$('.team-count-btn');for(var i=0;i<teamCountBtns.length;i++){teamCountBtns[i].onclick=function(){for(var j=0;j<teamCountBtns.length;j++)teamCountBtns[j].classList.remove('selected');this.classList.add('selected');state.teamCount=parseInt(this.getAttribute('data-count'));updateTeamSelectUI()}}var teamBtns=$$('.team-select-btn');for(var i=0;i<teamBtns.length;i++){teamBtns[i].onclick=function(){for(var j=0;j<teamBtns.length;j++)teamBtns[j].classList.remove('selected');this.classList.add('selected');state.myTeam=parseInt(this.getAttribute('data-team'))}}var diffBtns=$$('.diff-btn');for(var i=0;i<diffBtns.length;i++){diffBtns[i].onclick=function(){for(var j=0;j<diffBtns.length;j++)diffBtns[j].classList.remove('selected');this.classList.add('selected');state.difficulty=this.getAttribute('data-diff')}}$('create-btn').onclick=createGame;$('join-btn').onclick=joinGame;$('start-btn').onclick=startGame;$('reset-btn').onclick=resetGame;$('back-btn').onclick=backToHome;$('game-code').onkeypress=function(e){if(e.key==='Enter')joinGame()};updateModeUI()}
        function updateModeUI(){var isTeam=state.mode==='team';$('team-count-select').classList.toggle('show',isTeam);$('team-select-grid').classList.toggle('show',isTeam);if(isTeam){updateTeamSelectUI();if(!state.myTeam)state.myTeam=1}}
        function updateTeamSelectUI(){var btns=$$('.team-select-btn');for(var i=0;i<btns.length;i++){var teamNum=parseInt(btns[i].getAttribute('data-team'));btns[i].style.display=teamNum<=state.teamCount?'block':'none'}}
        function initFirebase(){firebase.initializeApp(CONFIG.FIREBASE);state.db=firebase.database();state.db.ref('.info/connected').on('value',function(snap){state.connected=snap.val()===true;updateConnection(state.connected?'online':'offline')})}
        function createGame(){state.playerName=$('player-name').value.trim();if(!state.playerName){showError('Bitte Namen eingeben!');return}if(state.mode==='team'&&!state.myTeam){showError('Bitte Team w√§hlen!');return}state.gameCode=generateCode();state.playerId='host_'+Date.now();state.isHost=true;state.myScore=0;state.questions=shuffle(QUESTIONS[state.difficulty]).slice(0,CONFIG.QUESTIONS_COUNT);state.teamScores={};if(state.mode==='team'){for(var i=1;i<=state.teamCount;i++)state.teamScores[i]=0}var gameData={status:'lobby',mode:state.mode,teamCount:state.teamCount,difficulty:state.difficulty,questions:state.questions,currentQuestion:-1,questionStart:null,host:state.playerId,created:Date.now()};state.gameRef=state.db.ref(CONFIG.DB_PATH+'/'+state.gameCode);state.playersRef=state.db.ref(CONFIG.DB_PATH+'/'+state.gameCode+'/players');state.scoresRef=state.db.ref(CONFIG.DB_PATH+'/'+state.gameCode+'/teamScores');state.gameRef.remove().then(function(){return state.gameRef.set(gameData)}).then(function(){if(state.mode==='team')return state.scoresRef.set(state.teamScores)}).then(function(){var playerData={name:state.playerName,score:0,isHost:true,answered:false,online:true};if(state.mode==='team')playerData.team=state.myTeam;return state.playersRef.child(state.playerId).set(playerData)}).then(function(){state.playersRef.child(state.playerId).onDisconnect().update({online:false});setupGameListeners();showLobby()}).catch(function(err){console.error(err);showError('Fehler beim Erstellen!')})}
        function joinGame(){state.playerName=$('player-name').value.trim();state.gameCode=$('game-code').value.trim().toUpperCase();if(!state.playerName){showError('Bitte Namen eingeben!');return}if(!state.gameCode||state.gameCode.length!==4){showError('Bitte 4-stelligen Code eingeben!');return}state.playerId='p_'+Date.now()+'_'+Math.random().toString(36).substr(2,4);state.isHost=false;state.myScore=0;state.gameRef=state.db.ref(CONFIG.DB_PATH+'/'+state.gameCode);state.playersRef=state.db.ref(CONFIG.DB_PATH+'/'+state.gameCode+'/players');state.scoresRef=state.db.ref(CONFIG.DB_PATH+'/'+state.gameCode+'/teamScores');state.gameRef.once('value').then(function(snap){if(!snap.exists()){showError('Spiel nicht gefunden!');return Promise.reject('not_found')}var game=snap.val();if(game.status!=='lobby'){showError('Spiel l√§uft bereits!');return Promise.reject('already_started')}state.mode=game.mode;state.teamCount=game.teamCount||2;state.difficulty=game.difficulty;state.questions=game.questions;if(state.mode==='team'&&(!state.myTeam||state.myTeam>state.teamCount))state.myTeam=1;var playerData={name:state.playerName,score:0,isHost:false,answered:false,online:true};if(state.mode==='team')playerData.team=state.myTeam;return state.playersRef.child(state.playerId).set(playerData)}).then(function(){state.playersRef.child(state.playerId).onDisconnect().update({online:false});setupGameListeners();showLobby()}).catch(function(err){if(err!=='not_found'&&err!=='already_started')showError('Fehler beim Beitreten!')})}
        function setupGameListeners(){state.playersRef.on('value',function(snap){var players=[];snap.forEach(function(child){var p=child.val();if(p&&p.name){p.id=child.key;players.push(p)}});state.players=players;updatePlayersUI()});if(state.mode==='team')state.scoresRef.on('value',function(snap){var scores=snap.val();if(scores){state.teamScores=scores;updateScoreboardUI()}});state.gameRef.on('value',function(snap){var game=snap.val();if(!game){backToHome();return}if(game.status==='playing'){showScreen('game-screen');if(game.currentQuestion!==state.currentQuestion){state.currentQuestion=game.currentQuestion;state.answered=false;showQuestion(game.questionStart)}}else if(game.status==='finished'){showResults()}})}
        function cleanupListeners(){if(state.gameRef)state.gameRef.off();if(state.playersRef)state.playersRef.off();if(state.scoresRef)state.scoresRef.off();if(state.timerInterval)clearInterval(state.timerInterval)}
        function showLobby(){showScreen('lobby-screen');$('lobby-code').textContent=state.gameCode;$('lobby-mode').textContent=state.mode==='team'?'üë• '+state.teamCount+' Teams':'üë§ Einzeln';var diffText={einfach:'üü¢ Einfach',mittel:'üü° Mittel',schwer:'üî¥ Schwer'};$('lobby-diff').textContent=diffText[state.difficulty];$('host-controls').style.display=state.isHost?'block':'none';$('player-controls').style.display=state.isHost?'none':'block';$('players-list').style.display=state.mode==='einzeln'?'block':'none';$('teams-list').style.display=state.mode==='team'?'block':'none'}
        function updatePlayersUI(){if(state.mode==='einzeln'){var html='';for(var i=0;i<state.players.length;i++){var p=state.players[i];if(p.online===false)continue;html+='<div class="player-chip'+(p.isHost?' host':'')+'">'+p.name+(p.isHost?' üëë':'')+'</div>'}$('players-grid').innerHTML=html||'<span style="opacity:0.5">Warte auf Spieler...</span>'}else{var grid=$('teams-grid');grid.className='teams-grid t'+state.teamCount;var html='';for(var t=1;t<=state.teamCount;t++){html+='<div class="team-box t'+t+'"><h4><span class="dot"></span>Team '+t+'</h4><div class="team-players">';var teamPlayers=[];for(var i=0;i<state.players.length;i++){if(state.players[i].team===t&&state.players[i].online!==false)teamPlayers.push(state.players[i])}if(teamPlayers.length>0){for(var j=0;j<teamPlayers.length;j++)html+='<span class="team-player">'+teamPlayers[j].name+(teamPlayers[j].isHost?' üëë':'')+'</span>'}else{html+='<span style="opacity:0.4;font-size:0.8em">Leer</span>'}html+='</div></div>'}grid.innerHTML=html}var nonHostCount=0;for(var i=0;i<state.players.length;i++){if(!state.players[i].isHost&&state.players[i].online!==false)nonHostCount++}$('start-btn').disabled=nonHostCount===0;var liveHtml='';for(var i=0;i<state.players.length;i++){var p=state.players[i];if(p.online===false)continue;var classes='live-player';if(p.answered)classes+=' answered';if(p.id===state.playerId)classes+=' me';liveHtml+='<span class="'+classes+'">'+p.name+'</span>'}$('live-players-grid').innerHTML=liveHtml}
        function updateScoreboardUI(){if(state.mode!=='team')return;var sb=$('scoreboard');sb.style.display='flex';var html='';for(var t=1;t<=state.teamCount;t++){html+='<div class="score-item t'+t+'"><div class="team-name">Team '+t+'</div><div class="team-score">'+(state.teamScores[t]||0)+'</div></div>'}sb.innerHTML=html}
        function startGame(){if(!state.isHost)return;state.playersRef.once('value').then(function(snap){var updates={};snap.forEach(function(child){updates[child.key+'/answered']=false;updates[child.key+'/score']=0});return state.playersRef.update(updates)}).then(function(){if(state.mode==='team'){var scores={};for(var i=1;i<=state.teamCount;i++)scores[i]=0;return state.scoresRef.set(scores)}}).then(function(){return state.gameRef.update({status:'playing',currentQuestion:0,questionStart:Date.now()})})}
        function resetGame(){if(!state.isHost||!confirm('Spiel wirklich zur√ºcksetzen?'))return;state.currentQuestion=-1;state.myScore=0;$('feedback').className='feedback';state.gameRef.update({status:'lobby',currentQuestion:-1,questionStart:null});state.playersRef.once('value').then(function(snap){var updates={};snap.forEach(function(child){updates[child.key+'/answered']=false;updates[child.key+'/score']=0});return state.playersRef.update(updates)});if(state.mode==='team'){var scores={};for(var i=1;i<=state.teamCount;i++)scores[i]=0;state.scoresRef.set(scores)}showScreen('lobby-screen')}
        function showQuestion(startTime){if(state.currentQuestion>=state.questions.length){state.gameRef.update({status:'finished'});return}var q=state.questions[state.currentQuestion];$('question-counter').textContent=(state.currentQuestion+1)+'/'+state.questions.length;$('category').textContent=q.cat;$('question').textContent=q.q;$('my-score').textContent='‚≠ê '+state.myScore;if(state.mode==='team'){var ti=$('my-team-indicator');ti.style.display='inline-block';ti.className='my-team-indicator t'+state.myTeam;ti.textContent='Team '+state.myTeam}var indices=shuffle([0,1,2,3]);var answersHtml='';for(var i=0;i<indices.length;i++){answersHtml+='<button class="answer-btn" data-idx="'+indices[i]+'">'+q.a[indices[i]]+'</button>'}$('answers').innerHTML=answersHtml;var btns=$$('.answer-btn');for(var i=0;i<btns.length;i++){btns[i].onclick=function(){selectAnswer(this,parseInt(this.getAttribute('data-idx')))}}$('feedback').className='feedback';startTimer(startTime)}
        function selectAnswer(btn,idx){if(state.answered)return;state.answered=true;var q=state.questions[state.currentQuestion];var isCorrect=idx===q.c;var btns=$$('.answer-btn');for(var i=0;i<btns.length;i++){btns[i].disabled=true;if(parseInt(btns[i].getAttribute('data-idx'))===q.c)btns[i].classList.add('correct')}if(!isCorrect)btn.classList.add('wrong');var fb=$('feedback');if(isCorrect){var points=Math.max(1,parseInt($('timer').textContent));state.myScore+=points;$('my-score').textContent='‚≠ê '+state.myScore;fb.textContent='‚úÖ Richtig! +'+points+' Punkte';fb.className='feedback correct show';state.playersRef.child(state.playerId).update({score:state.myScore,answered:true});if(state.mode==='team')state.scoresRef.child(state.myTeam).transaction(function(c){return(c||0)+1})}else{fb.textContent='‚ùå Falsch! Richtig: '+q.a[q.c];fb.className='feedback wrong show';state.playersRef.child(state.playerId).update({answered:true})}}
        function startTimer(startTime){if(state.timerInterval)clearInterval(state.timerInterval);var timerEl=$('timer');function tick(){var elapsed=Math.floor((Date.now()-startTime)/1000);var remaining=Math.max(0,CONFIG.TIMER_SECONDS-elapsed);timerEl.textContent=remaining;timerEl.className='timer';if(remaining<=2)timerEl.classList.add('danger');else if(remaining<=4)timerEl.classList.add('warning');if(remaining===0){clearInterval(state.timerInterval);handleTimeout()}}tick();state.timerInterval=setInterval(tick,200)}
        function handleTimeout(){if(!state.answered){state.answered=true;var q=state.questions[state.currentQuestion];var btns=$$('.answer-btn');for(var i=0;i<btns.length;i++){btns[i].disabled=true;if(parseInt(btns[i].getAttribute('data-idx'))===q.c)btns[i].classList.add('correct')}var fb=$('feedback');fb.textContent='‚è∞ Zeit abgelaufen! Richtig: '+q.a[q.c];fb.className='feedback timeout show';state.playersRef.child(state.playerId).update({answered:true})}if(state.isHost){setTimeout(function(){if(state.currentQuestion+1>=state.questions.length){state.gameRef.update({status:'finished'})}else{state.playersRef.once('value').then(function(snap){var updates={};snap.forEach(function(child){updates[child.key+'/answered']=false});return state.playersRef.update(updates)}).then(function(){state.gameRef.update({currentQuestion:state.currentQuestion+1,questionStart:Date.now()})})}},CONFIG.TRANSITION_DELAY)}}
        function showResults(){if(state.timerInterval)clearInterval(state.timerInterval);showScreen('result-screen');if(state.mode==='einzeln'){var sorted=state.players.slice().sort(function(a,b){return(b.score||0)-(a.score||0)});var myRank=1;for(var i=0;i<sorted.length;i++){if(sorted[i].id===state.playerId){myRank=i+1;break}}var icons=['ü•á','ü•à','ü•â'];$('result-icon').textContent=icons[myRank-1]||'üèÅ';$('result-title').textContent=myRank===1?'Du hast gewonnen!':'Platz '+myRank+'!';var html='';for(var i=0;i<sorted.length;i++){var p=sorted[i];var classes='standing-row';if(i===0)classes+=' winner';if(p.id===state.playerId)classes+=' me';html+='<div class="'+classes+'"><span class="standing-rank">'+(icons[i]||(i+1)+'.')+'</span><span class="standing-name">'+p.name+'</span><span class="standing-score">‚≠ê '+(p.score||0)+'</span></div>'}$('final-standings').innerHTML=html}else{var teams=[];for(var t=1;t<=state.teamCount;t++){teams.push({team:t,score:state.teamScores[t]||0})}teams.sort(function(a,b){return b.score-a.score});var winnerTeam=teams[0].team;var iWon=state.myTeam===winnerTeam;var icons=['ü•á','ü•à','ü•â'];$('result-icon').textContent=iWon?'üèÜ':'üèÅ';$('result-title').textContent=iWon?'Dein Team hat gewonnen!':'Team '+winnerTeam+' gewinnt!';var html='';for(var i=0;i<teams.length;i++){var t=teams[i];var classes='standing-row';if(i===0)classes+=' winner';if(t.team===state.myTeam)classes+=' me';html+='<div class="'+classes+'"><span class="standing-rank">'+(icons[i]||(i+1)+'.')+'</span><span class="standing-name">Team '+t.team+'</span><span class="standing-score">'+t.score+' Punkte</span></div>'}$('final-standings').innerHTML=html}}
        function backToHome(){cleanupListeners();if(state.playersRef&&state.playerId)state.playersRef.child(state.playerId).remove();state.gameCode=null;state.playerId=null;state.isHost=false;state.currentQuestion=-1;state.myScore=0;state.players=[];state.teamScores={};$('game-code').value='';showScreen('login-screen')}
        function init(){initFirebase();setupUI()}
        window.onload=init
    })();
    </script>
    <script data-goatcounter="https://aguitoo.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
</body>
</html>
